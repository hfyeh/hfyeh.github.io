<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>sharefun</title><meta name=description content><meta name=author content><link rel="preload stylesheet" href=https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.css><script src=https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script>MathJax={tex:{inlineMath:[["$","$"]],displayMath:[["$$","$$"]]}}</script><script id=MathJax-script defer src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script>
<link rel="preload stylesheet" href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/styles/gruvbox-dark.min.css><script defer src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/highlight.min.js onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon type=image/x-icon href=https://hfyeh.github.io/images/favicon.ico><link rel=apple-touch-icon href=https://hfyeh.github.io/images/apple-touch-icon-dark.png><link rel=stylesheet href=https://hfyeh.github.io/stylesheets/dark.css><link rel="preload stylesheet" as=style href=https://hfyeh.github.io/custom.min.css><meta name=generator content="Hugo 0.107.0"><link rel=alternate type=application/rss+xml href=https://hfyeh.github.io/index.xml title=sharefun><meta property="og:title" content="sharefun"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://hfyeh.github.io/"><meta itemprop=name content="sharefun"><meta itemprop=description content><meta name=twitter:card content="summary"><meta name=twitter:title content="sharefun"><meta name=twitter:description content></head><body><div class="grid grid-centered-extended"><div class=grid-cell><nav class="header-nav scrollappear"><a href=/ class=header-logo title=sharefun>sharefun</a><ul class=header-links><li><a href=https://www.facebook.com/sharefun010407 rel="noreferrer noopener" target=_blank title=Facebook><svg xmlns="http://www.w3.org/2000/svg" class="icon-facebook"><use href="https://hfyeh.github.io/icons/facebook.svg#icon-facebook" xlink:href="https://hfyeh.github.io/icons/facebook.svg#icon-facebook"/></svg></a></li><li><a href=https://github.com/hfyeh rel="noreferrer noopener" target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon-github"><use href="https://hfyeh.github.io/icons/github.svg#icon-github" xlink:href="https://hfyeh.github.io/icons/github.svg#icon-github"/></svg></a></li><li><a href=https://twitter.com/SharefunYeh rel="noreferrer noopener" target=_blank title=Twitter><svg xmlns="http://www.w3.org/2000/svg" class="icon-twitter"><use href="https://hfyeh.github.io/icons/twitter.svg#icon-twitter" xlink:href="https://hfyeh.github.io/icons/twitter.svg#icon-twitter"/></svg></a></li></ul></nav><div class=row><main class=column style=flex:2><ul class=article-list><li class="article-list-item scrollappear"><h2><a href=https://hfyeh.github.io/posts/a-minimal-example-of-concurrent-python/ title="A Minimal Example of Concurrent Python">A Minimal Example of Concurrent Python</a></h2><div class=article-list-header><span class=article-list-date>April 22, 2022</span></div><p><p>The CPython interpreter usese <a href=https://wiki.python.org/moin/GlobalInterpreterLock>GIL</a> (global interpreter lock), to prevent threads from executing Python bytecodes at once.</p><p>Suppose I have two components who need to be run in parallel in a modern multi-core processor. Say, <code>add</code> and <code>mul</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>add</span>(n: int) <span style=color:#f92672>-&gt;</span> int:
</span></span><span style=display:flex><span>    result <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(n):
</span></span><span style=display:flex><span>        result <span style=color:#f92672>+=</span> (i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> result
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>mul</span>(n: int) <span style=color:#f92672>-&gt;</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>    <span style=color:#75715e># Run many times to get longer execution period</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>4000000</span>):
</span></span><span style=display:flex><span>        result <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(n):
</span></span><span style=display:flex><span>            result <span style=color:#f92672>*=</span> (i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> result
</span></span></code></pre></div><p>Impose that these two tiny components have to be run sequentially, <code>mul</code> recieves <code>add</code>&rsquo;s output.</p><pre tabindex=0><code class=language-mermaid data-lang=mermaid>sequenceDiagram
    participant main
    participant mul
    participant add
    main-&gt;&gt;mul: For every stdin
    activate main
    mul-&gt;&gt;add: result
    add-&gt;&gt;mul: 
    mul-&gt;&gt;main: 
    deactivate main
</code></pre><p>Run it twice and fix the input of <code>mul</code> to be 11 for demonstration purpose. Note here I print the time log to the standard error on purpose. The code is listed below.</p><div class=article-list-read-more><a href=https://hfyeh.github.io/posts/a-minimal-example-of-concurrent-python/ title="Read more" class=article-list-read-more>Read more<svg xmlns="http://www.w3.org/2000/svg" class="icon-arrow-right"><use href="https://hfyeh.github.io/icons/arrow-right.svg#icon-arrow-right" xlink:href="https://hfyeh.github.io/icons/arrow-right.svg#icon-arrow-right"/></svg></a></div></p></p></li><li class="article-list-item scrollappear"><h2><a href=https://hfyeh.github.io/posts/uml-class-diagram/ title="A Note on UML Class Diagram">A Note on UML Class Diagram</a></h2><div class=article-list-header><span class=article-list-date>March 30, 2022</span></div><p><p>這是一篇學習 UML class diagram 的簡記。為保持文意清晰和，用到術語時盡可能使用原文表示。</p><div class=article-list-read-more><a href=https://hfyeh.github.io/posts/uml-class-diagram/ title="Read more" class=article-list-read-more>Read more<svg xmlns="http://www.w3.org/2000/svg" class="icon-arrow-right"><use href="https://hfyeh.github.io/icons/arrow-right.svg#icon-arrow-right" xlink:href="https://hfyeh.github.io/icons/arrow-right.svg#icon-arrow-right"/></svg></a></div></p></p></li><li class="article-list-item scrollappear"><h2><a href=https://hfyeh.github.io/posts/books-from-sbyang.md/ title=聖誕書盒>聖誕書盒</a></h2><div class=article-list-header><span class=article-list-date>December 31, 2021</span></div><p><p>初看<a href=https://www.facebook.com/YangSzuPang>楊斯棓</a>醫師發文說要贈送書盒，我心裡想：『書盒是什麼東西？』該文章附圖是一個個的紙箱，不知裡面是什麼，也沒再探究。幾天後，陸續看到其他收到「書盒」的人開箱分享，才驚覺原來送的是書啊！</p><p>看著分享文中那些楊醫師精心挑選，主題圍繞在台灣、自由的書，著實心動，沒有履行再次參加有獎徵讀書心得承諾的我只好把羞恥心埋起來，伸手索書。</p><div class=article-list-read-more><a href=https://hfyeh.github.io/posts/books-from-sbyang.md/ title="Read more" class=article-list-read-more>Read more<svg xmlns="http://www.w3.org/2000/svg" class="icon-arrow-right"><use href="https://hfyeh.github.io/icons/arrow-right.svg#icon-arrow-right" xlink:href="https://hfyeh.github.io/icons/arrow-right.svg#icon-arrow-right"/></svg></a></div></p></p></li><li class="article-list-item scrollappear"><h2><a href=https://hfyeh.github.io/posts/ieee754-float-check/ title="C 語言中的浮點數與 IEEE 754">C 語言中的浮點數與 IEEE 754</a></h2><div class=article-list-header><span class=article-list-date>July 2, 2019</span></div><p><p>今天與同事討論 C 語言中，對一個浮點數取 floor 的問題。剛好最近有看到 IEEE 754 標準如何規範浮點數格式<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>，就趁此機會仔細驗證一下。仍建議看第一手資料，以下純為記錄和分享用途而已。</p><p>先從一個問題開始，我用 GCC 編譯以下的程式碼並執行：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>floor<span style=color:#f92672>(</span>f1<span style=color:#f92672>)</span>, <span style=color:#ae81ff>20</span> digital points: 2.00000000000000000000
</span></span><span style=display:flex><span>floor<span style=color:#f92672>(</span>f2<span style=color:#f92672>)</span>, <span style=color:#ae81ff>20</span> digital points: 3.00000000000000000000
</span></span></code></pre></div><p>為什麼 2.999999 取 floor 得到 2.0，而 2.9999999 取 floor 會得到 3.0 呢？我們的都知道，是因為浮點數有精度問題，單精度浮點數的精準度在絕大多數的機器上有效位數只到小數後第六位。這篇的目標就是從標準的角度去親自確認這件事情。</p><div class=article-list-read-more><a href=https://hfyeh.github.io/posts/ieee754-float-check/ title="Read more" class=article-list-read-more>Read more<svg xmlns="http://www.w3.org/2000/svg" class="icon-arrow-right"><use href="https://hfyeh.github.io/icons/arrow-right.svg#icon-arrow-right" xlink:href="https://hfyeh.github.io/icons/arrow-right.svg#icon-arrow-right"/></svg></a></div></p></p></li><li class="article-list-item scrollappear"><h2><a href=https://hfyeh.github.io/posts/chingtao-east-road/ title=《青島東路三號：我的百年之憶及台灣的荒謬年代》：白色恐怖受難者的記憶歷史>《青島東路三號：我的百年之憶及台灣的荒謬年代》：白色恐怖受難者的記憶歷史</a></h2><div class=article-list-header><span class=article-list-date>April 5, 2017</span></div><p><p>讀者：<a href=https://www.facebook.com/sharefun010407>葉學舫</a></p><p><img src=https://imgur.com/24lIhsh.png alt=青島東路三號：我的百年之憶及台灣的荒謬年代></p><p>這是一本白色恐怖受難者的記憶歷史。作者顏世鴻先生因為加入共產黨被逮捕至保密局北所、青島東路的軍法處，後囚禁於綠島和小琉球共十三餘年。顏君強記獄中事件，於獲釋後用兩天的時間抄寫出來，完成《霜降》一書，以此為獄友立傳。此書即是《霜降》第三次改寫而成。</p><div class=article-list-read-more><a href=https://hfyeh.github.io/posts/chingtao-east-road/ title="Read more" class=article-list-read-more>Read more<svg xmlns="http://www.w3.org/2000/svg" class="icon-arrow-right"><use href="https://hfyeh.github.io/icons/arrow-right.svg#icon-arrow-right" xlink:href="https://hfyeh.github.io/icons/arrow-right.svg#icon-arrow-right"/></svg></a></div></p></p></li><li class="article-list-item scrollappear"><h2><a href=https://hfyeh.github.io/posts/the-inner-game-of-tennis/ title=《網球的內心遊戲》：運動場域的學習心法是放鬆的專注>《網球的內心遊戲》：運動場域的學習心法是放鬆的專注</a></h2><div class=article-list-header><span class=article-list-date>March 19, 2017</span></div><p><p>讀者：<a href=https://www.facebook.com/sharefun010407>葉學舫</a></p><p><img src=https://i.imgur.com/UTRBSU5.png alt="The Inner Game of Tennis"></p><p>這本書講的是運動的學習方法。而且標題與內容不符，這不是一本網球運動基本動作指南，而是一個網球教練（W. Timothy Gallwey）總結出的，對於頂尖的運動選手都適用的身體訓練指南。</p><div class=article-list-read-more><a href=https://hfyeh.github.io/posts/the-inner-game-of-tennis/ title="Read more" class=article-list-read-more>Read more<svg xmlns="http://www.w3.org/2000/svg" class="icon-arrow-right"><use href="https://hfyeh.github.io/icons/arrow-right.svg#icon-arrow-right" xlink:href="https://hfyeh.github.io/icons/arrow-right.svg#icon-arrow-right"/></svg></a></div></p></p></li><li class="article-list-item scrollappear"><h2><a href=https://hfyeh.github.io/posts/being-a-rails-developer-after-one-year/ title="轉職 Rails 工程師的一年後">轉職 Rails 工程師的一年後</a></h2><div class=article-list-header><span class=article-list-date>March 19, 2017</span></div><p><p><img src=https://imgur.com/m1TNik4.png alt></p><p>轉職為 Rails 工程師滿一年了。</p><p>這一年，坦白說薪資並不多，福利也普通，但是個人思想面和技術面的成長，完全是過去的我無法想像的。而且在這個圈子裡，我找到竹科公司無法給的，那心目中理想的工作環境。至今我仍可以很肯定的說，當初離開相對高薪工作的決定是對的。</p><div class=article-list-read-more><a href=https://hfyeh.github.io/posts/being-a-rails-developer-after-one-year/ title="Read more" class=article-list-read-more>Read more<svg xmlns="http://www.w3.org/2000/svg" class="icon-arrow-right"><use href="https://hfyeh.github.io/icons/arrow-right.svg#icon-arrow-right" xlink:href="https://hfyeh.github.io/icons/arrow-right.svg#icon-arrow-right"/></svg></a></div></p></p></li><li class="article-list-item scrollappear"><h2><a href=https://hfyeh.github.io/posts/chen-and-taiwan-doctors-in-world-war-two/ title=《此心不沉：陳纂地與二戰末期台灣人醫生》：二二八事件中台灣武裝起義的人物>《此心不沉：陳纂地與二戰末期台灣人醫生》：二二八事件中台灣武裝起義的人物</a></h2><div class=article-list-header><span class=article-list-date>February 28, 2017</span></div><p><p>讀者：<a href=https://www.facebook.com/sharefun010407>葉學舫</a></p><p><img src=https://imgur.com/vTbBt5x.png alt=此心不沉：陳纂地與二戰末期台灣人醫生></p><p>撇除義務教育時期被動接受的資訊，我真正了解二戰前後台灣這塊土地上的人事物，是始於王鼎鈞的《關山奪路》，其後是《百年追求卷一自治的夢想》，再來就是《此心不沉：陳纂地與二戰末期台灣人醫生》。《關山奪路》講述鼎鈞先生從流亡學生，到被國民黨徵召（或說矇騙）進入憲兵隊，在中國繞了大半圈後隨著國民政府來台的故事。《百年追求》訴說日治中期開始，台灣本土菁英和學生追求民主化的過程，一直到二二八事件後數年。《此心不沉》從被日人徵召入伍的台灣醫生為視角，描述本土菁英關懷台灣前途，二二八之際武裝起來，採取激烈手段力拒國民黨統治，事敗後藏身山中四年多，最後在特務監視下終老的故事。</p><div class=article-list-read-more><a href=https://hfyeh.github.io/posts/chen-and-taiwan-doctors-in-world-war-two/ title="Read more" class=article-list-read-more>Read more<svg xmlns="http://www.w3.org/2000/svg" class="icon-arrow-right"><use href="https://hfyeh.github.io/icons/arrow-right.svg#icon-arrow-right" xlink:href="https://hfyeh.github.io/icons/arrow-right.svg#icon-arrow-right"/></svg></a></div></p></p></li><li class="article-list-item scrollappear"><h2><a href=https://hfyeh.github.io/posts/syuhai-with-friend/ title=偕友觀潮於旭海>偕友觀潮於旭海</a></h2><div class=article-list-header><span class=article-list-date>January 1, 2008</span></div><p><p>百里寒冬風割面，遊心一夜到雲巔。</p><p>枋山鐵道尋陳跡，旭海長亭度陌阡。</p><p>華舍錦衾高索費，紅霞碧海不需錢。</p><p>驚瀾散去復歸海，談笑盡時情自延。</p><div class=article-list-read-more><a href=https://hfyeh.github.io/posts/syuhai-with-friend/ title="Read more" class=article-list-read-more>Read more<svg xmlns="http://www.w3.org/2000/svg" class="icon-arrow-right"><use href="https://hfyeh.github.io/icons/arrow-right.svg#icon-arrow-right" xlink:href="https://hfyeh.github.io/icons/arrow-right.svg#icon-arrow-right"/></svg></a></div></p></p></li></ul></main><aside class=column style=flex:1><div style="padding:10px 0 10px 30px"><a class=twitter-timeline data-height=1000 data-theme=dark href="https://twitter.com/SharefunYeh?ref_src=twsrc%5Etfw">Tweets by Hsueh-Fang Yeh</a> <script async src=https://platform.twitter.com/widgets.js></script></div></aside></div><footer class="footer scrollappear"><p><span>&copy; 2022 <a href=https://hfyeh.github.io>sharefun</a></span>
<span>Powered by <a href=https://gohugo.io/ rel=noopener target=_blank>Hugo</a></span>
<span>Theme is based on <a href=https://github.com/nielsenramon/chalk rel="noreferrer noopener" target=_blank>Chalk</a></span></p></footer><script>var config={startOnLoad:!0,theme:"forest",classDiagram:{useMaxWidth:!1,htmlLabels:!0}};mermaid.initialize(config),window.mermaid.init(void 0,document.querySelectorAll(".language-mermaid"))</script><style>.language-mermaid>svg{background-color:#e8e8e8}</style></div></div></main><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js></script>
<script src=https://hfyeh.github.io/javascripts/zooming.min.js></script>
<script src=https://hfyeh.github.io/javascripts/retina.min.js></script>
<script src=https://hfyeh.github.io/javascripts/svgxuse.min.js></script>
<script src=https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js></script>
<script src=https://hfyeh.github.io/javascripts/vendor.min.js></script>
<script src=https://hfyeh.github.io/javascripts/webfonts.min.js></script>
<script src=https://hfyeh.github.io/javascripts/scrollappear.min.js></script>
<script src=https://hfyeh.github.io/javascripts/application.min.js></script></body></html>